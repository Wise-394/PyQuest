[gd_scene format=3 uid="uid://cx2ljcqbkehra"]

[ext_resource type="Texture2D" uid="uid://dk7ynn0tos83i" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 01.png" id="1_27us2"]
[ext_resource type="Script" uid="uid://rnig7bxkab7d" path="res://script/character/crab/crab.gd" id="1_admx7"]
[ext_resource type="Texture2D" uid="uid://dqbydspl4s1fp" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 02.png" id="2_admx7"]
[ext_resource type="Texture2D" uid="uid://sas3707htltr" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/06-Anticipation/Anticipation 01.png" id="2_nieqb"]
[ext_resource type="Texture2D" uid="uid://d2qrfs4r6vu0m" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/08-Hit/Hit 01.png" id="2_oxgc6"]
[ext_resource type="Texture2D" uid="uid://sgjpv2dy1bo2" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 03.png" id="3_8jhn6"]
[ext_resource type="Texture2D" uid="uid://bish4232lgbwe" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/08-Hit/Hit 02.png" id="3_pajt7"]
[ext_resource type="Texture2D" uid="uid://0jkhs51mf41g" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/06-Anticipation/Anticipation 02.png" id="3_ud2wr"]
[ext_resource type="Texture2D" uid="uid://chhxgt0cuardg" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 04.png" id="4_f3puh"]
[ext_resource type="Texture2D" uid="uid://dfqv4yu8pcs5q" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/06-Anticipation/Anticipation 03.png" id="4_l68qe"]
[ext_resource type="Texture2D" uid="uid://5i22brg0hgxk" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/08-Hit/Hit 03.png" id="4_pudux"]
[ext_resource type="Texture2D" uid="uid://cnfwa63hsv1rb" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 05.png" id="5_d6g0r"]
[ext_resource type="Texture2D" uid="uid://c4v62ld6avnin" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/08-Hit/Hit 04.png" id="5_gctqi"]
[ext_resource type="Texture2D" uid="uid://b8nb032mq7qt7" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/07-Attack/Attack 01.png" id="5_ijmw0"]
[ext_resource type="Texture2D" uid="uid://3u53eh0wmmcj" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/09-Dead Hit/Dead Hit 01.png" id="6_6m2du"]
[ext_resource type="Texture2D" uid="uid://cj8vxypf01jln" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/07-Attack/Attack 02.png" id="6_10ces"]
[ext_resource type="Texture2D" uid="uid://c5vofih71f6ah" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 06.png" id="6_86n2j"]
[ext_resource type="Texture2D" uid="uid://big1is7kn4f7m" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 07.png" id="7_1gotc"]
[ext_resource type="Texture2D" uid="uid://bntwb6remf2oe" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/09-Dead Hit/Dead Hit 02.png" id="7_maayw"]
[ext_resource type="Texture2D" uid="uid://c502abjc65n4e" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/07-Attack/Attack 03.png" id="7_u7c0n"]
[ext_resource type="Texture2D" uid="uid://cbr3vdpfnvwg3" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/07-Attack/Attack 04.png" id="8_0yfew"]
[ext_resource type="Texture2D" uid="uid://bkgibg2ha33c6" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/09-Dead Hit/Dead Hit 03.png" id="8_sueps"]
[ext_resource type="Texture2D" uid="uid://dby0v7gnag5b2" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 08.png" id="8_ubkrn"]
[ext_resource type="Texture2D" uid="uid://dnr3sjrn02oqx" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/01-Idle/Idle 09.png" id="9_dub4w"]
[ext_resource type="Texture2D" uid="uid://bwbak6c2wvq0a" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/09-Dead Hit/Dead Hit 04.png" id="9_wqvsm"]
[ext_resource type="Texture2D" uid="uid://dobet34hwgbua" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/02-Run/Run 01.png" id="10_oxgc6"]
[ext_resource type="Texture2D" uid="uid://dyemy863mr37d" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/04-Fall/Fall 01.png" id="10_sueps"]
[ext_resource type="Texture2D" uid="uid://dewjqt7g3000i" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/02-Run/Run 02.png" id="11_pajt7"]
[ext_resource type="Texture2D" uid="uid://5wedtdyjcqq5" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/02-Run/Run 03.png" id="12_pudux"]
[ext_resource type="Texture2D" uid="uid://vgrh0dqpdb4" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/02-Run/Run 04.png" id="13_gctqi"]
[ext_resource type="Texture2D" uid="uid://8xr3iv0y5glr" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/02-Run/Run 05.png" id="14_mlx33"]
[ext_resource type="Texture2D" uid="uid://rm85dl0ufnyf" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Crabby/02-Run/Run 06.png" id="15_6m2du"]
[ext_resource type="Script" uid="uid://dwbl7tap1c6fd" path="res://script/character/state_machine.gd" id="17_f3puh"]
[ext_resource type="Script" uid="uid://ddecdfo2cun6a" path="res://script/character/crab/idle_state.gd" id="18_d6g0r"]
[ext_resource type="Script" uid="uid://cdktysp5le6qo" path="res://script/character/crab/move_state.gd" id="19_d6g0r"]
[ext_resource type="Script" uid="uid://cuwrc8c2tuosb" path="res://script/character/crab/damaged_state.gd" id="20_86n2j"]
[ext_resource type="Script" uid="uid://3qjmwva2v43v" path="res://script/character/crab/dead_state.gd" id="29_7lcgg"]
[ext_resource type="Script" uid="uid://dewkfqocmwk2i" path="res://script/character/crab/falling_state.gd" id="30_maayw"]
[ext_resource type="Script" uid="uid://b7jgmknef7l80" path="res://script/character/crab/top_hitbox.gd" id="33_nlgcd"]
[ext_resource type="Script" uid="uid://pyc687e8m2je" path="res://script/character/crab/hit_box.gd" id="33_q2o5a"]
[ext_resource type="Script" uid="uid://bgftrrtyqnwp2" path="res://script/character/crab/aggro_state.gd" id="39_10ces"]
[ext_resource type="Texture2D" uid="uid://dly38viokf7bn" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Dialogue/Exclamation/Exclamation In 03.png" id="40_0de0m"]
[ext_resource type="Script" uid="uid://jrgqi4ruv5cw" path="res://script/character/crab/vision.gd" id="40_u7c0n"]
[ext_resource type="Texture2D" uid="uid://dufmokhen46lk" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Dialogue/Exclamation/Exclamation Out 01.png" id="41_6vqjw"]
[ext_resource type="Texture2D" uid="uid://gfxs2fbkq0bb" path="res://assets/Treasure Hunters/The Crusty Crew/Sprites/Dialogue/Exclamation/Exclamation Out 02.png" id="42_s25gi"]
[ext_resource type="Script" uid="uid://c7qbj0nmxclk" path="res://script/character/crab/attack_state.gd" id="43_6vqjw"]
[ext_resource type="Script" uid="uid://dseiko8wix5ai" path="res://script/character/crab/anticipation_state.gd" id="44_s25gi"]
[ext_resource type="PackedScene" uid="uid://bjv2dsnjvb4np" path="res://scene/character/enemy_health_bar.tscn" id="47_cmos6"]

[sub_resource type="SpriteFrames" id="SpriteFrames_maayw"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_nieqb")
}, {
"duration": 1.0,
"texture": ExtResource("3_ud2wr")
}, {
"duration": 1.0,
"texture": ExtResource("4_l68qe")
}],
"loop": false,
"name": &"anticipation",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_ijmw0")
}, {
"duration": 1.0,
"texture": ExtResource("6_10ces")
}, {
"duration": 1.0,
"texture": ExtResource("7_u7c0n")
}, {
"duration": 1.0,
"texture": ExtResource("8_0yfew")
}],
"loop": false,
"name": &"attack",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_oxgc6")
}, {
"duration": 1.0,
"texture": ExtResource("3_pajt7")
}, {
"duration": 1.0,
"texture": ExtResource("4_pudux")
}, {
"duration": 1.0,
"texture": ExtResource("5_gctqi")
}],
"loop": false,
"name": &"damaged",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("6_6m2du")
}, {
"duration": 1.0,
"texture": ExtResource("7_maayw")
}, {
"duration": 1.0,
"texture": ExtResource("8_sueps")
}, {
"duration": 1.0,
"texture": ExtResource("9_wqvsm")
}],
"loop": false,
"name": &"dead",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("10_sueps")
}],
"loop": false,
"name": &"fall",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("1_27us2")
}, {
"duration": 1.0,
"texture": ExtResource("2_admx7")
}, {
"duration": 1.0,
"texture": ExtResource("3_8jhn6")
}, {
"duration": 1.0,
"texture": ExtResource("4_f3puh")
}, {
"duration": 1.0,
"texture": ExtResource("5_d6g0r")
}, {
"duration": 1.0,
"texture": ExtResource("6_86n2j")
}, {
"duration": 1.0,
"texture": ExtResource("7_1gotc")
}, {
"duration": 1.0,
"texture": ExtResource("8_ubkrn")
}, {
"duration": 1.0,
"texture": ExtResource("9_dub4w")
}],
"loop": true,
"name": &"idle",
"speed": 10.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("10_oxgc6")
}, {
"duration": 1.0,
"texture": ExtResource("11_pajt7")
}, {
"duration": 1.0,
"texture": ExtResource("12_pudux")
}, {
"duration": 1.0,
"texture": ExtResource("13_gctqi")
}, {
"duration": 1.0,
"texture": ExtResource("14_mlx33")
}, {
"duration": 1.0,
"texture": ExtResource("15_6m2du")
}],
"loop": true,
"name": &"walk",
"speed": 10.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_nlgcd"]
size = Vector2(43, 13)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_f3puh"]
size = Vector2(122, 16)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sueps"]
size = Vector2(41, 23)

[sub_resource type="SpriteFrames" id="SpriteFrames_q2o5a"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("42_s25gi")
}, {
"duration": 1.0,
"texture": ExtResource("41_6vqjw")
}, {
"duration": 1.0,
"texture": ExtResource("40_0de0m")
}],
"loop": false,
"name": &"default",
"speed": 10.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_10ces"]
size = Vector2(219, 51)

[node name="Crab" type="CharacterBody2D" unique_id=215597954 groups=["enemy"]]
collision_layer = 16
collision_mask = 3
script = ExtResource("1_admx7")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="." unique_id=1622535458]
sprite_frames = SubResource("SpriteFrames_maayw")
animation = &"attack"
autoplay = "idle"
frame = 3
frame_progress = 1.0

[node name="TopHitbox" type="Area2D" parent="." unique_id=120547608]
collision_layer = 0
script = ExtResource("33_nlgcd")

[node name="CollisionShape2D" type="CollisionShape2D" parent="TopHitbox" unique_id=712001142]
position = Vector2(1.5, -5.5)
shape = SubResource("RectangleShape2D_nlgcd")

[node name="HitBox" type="Area2D" parent="." unique_id=1156155908]
collision_layer = 0
script = ExtResource("33_q2o5a")

[node name="Collision" type="CollisionShape2D" parent="HitBox" unique_id=749674894]
position = Vector2(1, 5)
shape = SubResource("RectangleShape2D_f3puh")

[node name="HurtBox" type="CollisionShape2D" parent="." unique_id=1591342947]
position = Vector2(1.5, 1.5)
shape = SubResource("RectangleShape2D_sueps")

[node name="Exclamation" type="AnimatedSprite2D" parent="." unique_id=1116224480]
visible = false
position = Vector2(2, -24)
sprite_frames = SubResource("SpriteFrames_q2o5a")
frame = 1
frame_progress = 0.216586

[node name="StateMachine" type="Node" parent="." unique_id=385383053 node_paths=PackedStringArray("initial_state")]
script = ExtResource("17_f3puh")
initial_state = NodePath("IdleState")

[node name="IdleState" type="Node" parent="StateMachine" unique_id=1478469098]
script = ExtResource("18_d6g0r")

[node name="Timer" type="Timer" parent="StateMachine/IdleState" unique_id=913854341]
wait_time = 0.5

[node name="MoveState" type="Node" parent="StateMachine" unique_id=1935226817]
script = ExtResource("19_d6g0r")

[node name="Timer" type="Timer" parent="StateMachine/MoveState" unique_id=2085475205]

[node name="DamagedState" type="Node" parent="StateMachine" unique_id=839207765]
script = ExtResource("20_86n2j")

[node name="DeadState" type="Node" parent="StateMachine" unique_id=656244811]
script = ExtResource("29_7lcgg")

[node name="Timer" type="Timer" parent="StateMachine/DeadState" unique_id=1876375840]

[node name="FallingState" type="Node" parent="StateMachine" unique_id=302970254]
script = ExtResource("30_maayw")

[node name="AggroState" type="Node" parent="StateMachine" unique_id=1370668875]
script = ExtResource("39_10ces")
attack_range = 66

[node name="AttackState" type="Node" parent="StateMachine" unique_id=1415730218]
script = ExtResource("43_6vqjw")

[node name="AnticipationState" type="Node" parent="StateMachine" unique_id=1652210911]
script = ExtResource("44_s25gi")

[node name="RaycastLeft" type="RayCast2D" parent="." unique_id=611305275]
position = Vector2(-17, 8)
target_position = Vector2(0, 7)
collision_mask = 2

[node name="RaycastRight" type="RayCast2D" parent="." unique_id=117054266]
position = Vector2(20, 8)
target_position = Vector2(0, 7)
collision_mask = 2

[node name="Vision" type="Area2D" parent="." unique_id=1027076312]
collision_layer = 0
script = ExtResource("40_u7c0n")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Vision" unique_id=1032291555]
position = Vector2(-109.5, -12.5)
shape = SubResource("RectangleShape2D_10ces")

[node name="EnemyHealthBar" parent="." unique_id=412449344 instance=ExtResource("47_cmos6")]
visible = false
offset_left = -15.0
offset_top = -17.0
offset_right = 19.0
offset_bottom = -12.0

[connection signal="body_entered" from="TopHitbox" to="TopHitbox" method="_on_body_entered"]
[connection signal="body_entered" from="HitBox" to="HitBox" method="_on_body_entered"]
[connection signal="timeout" from="StateMachine/IdleState/Timer" to="StateMachine/IdleState" method="_on_timer_timeout"]
[connection signal="timeout" from="StateMachine/MoveState/Timer" to="StateMachine/MoveState" method="_on_timer_timeout"]
[connection signal="timeout" from="StateMachine/DeadState/Timer" to="StateMachine/DeadState" method="_on_timer_timeout"]
[connection signal="body_entered" from="Vision" to="Vision" method="_on_body_entered"]
[connection signal="body_exited" from="Vision" to="Vision" method="_on_body_exited"]
